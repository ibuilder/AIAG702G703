<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AIA G702/G703 Form Generator</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="styles.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.2/papaparse.min.js"></script>
</head>
<body class="bg-light">
    <div class="container-fluid py-4">
        <div id="toast-container"></div>
        
        <div class="row mb-4">
            <div class="col-12">
                <div class="card">
                    <div class="card-header bg-primary text-white">
                        <h2 class="mb-0">AIA G702/G703 Form Generator</h2>
                    </div>
                    <div class="card-body">
                        <ul class="nav nav-tabs" id="formTabs" role="tablist">
                            <li class="nav-item" role="presentation">
                                <button class="nav-link active" id="project-tab" data-bs-toggle="tab" data-bs-target="#project" type="button" role="tab" aria-controls="project" aria-selected="true">Project Info</button>
                            </li>
                            <li class="nav-item" role="presentation">
                                <button class="nav-link" id="g702-tab" data-bs-toggle="tab" data-bs-target="#g702" type="button" role="tab" aria-controls="g702" aria-selected="false">G702 Form</button>
                            </li>
                            <li class="nav-item" role="presentation">
                                <button class="nav-link" id="g703-tab" data-bs-toggle="tab" data-bs-target="#g703" type="button" role="tab" aria-controls="g703" aria-selected="false">G703 Form</button>
                            </li>
                            <li class="nav-item" role="presentation">
                                <button class="nav-link" id="gc-tab" data-bs-toggle="tab" data-bs-target="#gc" type="button" role="tab" aria-controls="gc" aria-selected="false">General Conditions</button>
                            </li>
                            <li class="nav-item" role="presentation">
                                <button class="nav-link" id="curve-tab" data-bs-toggle="tab" data-bs-target="#curve" type="button" role="tab" aria-controls="curve" aria-selected="false">Job Cost Curve</button>
                            </li>
                            <li class="nav-item" role="presentation">
                                <button class="nav-link" id="preview-tab" data-bs-toggle="tab" data-bs-target="#preview" type="button" role="tab" aria-controls="preview" aria-selected="false">Preview & Export</button>
                            </li>
                        </ul>
                        
                        <div class="tab-content" id="formTabsContent">
                            <!-- Project Info Tab -->
                            <div class="tab-pane fade show active" id="project" role="tabpanel" aria-labelledby="project-tab">
                                <div class="row mb-4">
                                    <div class="col-md-6">
                                        <h4>Project Information</h4>
                                        <div class="mb-3">
                                            <label for="projectName" class="form-label">Project Name</label>
                                            <input type="text" class="form-control" id="projectName" placeholder="Enter project name">
                                        </div>
                                        <div class="mb-3">
                                            <label for="projectLocation" class="form-label">Project Location</label>
                                            <input type="text" class="form-control" id="projectLocation" placeholder="Enter project location">
                                        </div>
                                        <div class="mb-3">
                                            <label for="projectNumber" class="form-label">Project Number</label>
                                            <input type="text" class="form-control" id="projectNumber" placeholder="Enter project number">
                                        </div>
                                        <div class="mb-3">
                                            <label for="contractDate" class="form-label">Contract Date</label>
                                            <input type="date" class="form-control" id="contractDate">
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <h4>Application Information</h4>
                                        <div class="mb-3">
                                            <label for="applicationNumber" class="form-label">Application Number</label>
                                            <input type="number" class="form-control" id="applicationNumber" min="1" value="1">
                                        </div>
                                        <div class="mb-3">
                                            <label for="applicationDate" class="form-label">Application Date</label>
                                            <input type="date" class="form-control" id="applicationDate">
                                        </div>
                                        <div class="mb-3">
                                            <label for="periodFrom" class="form-label">Period From</label>
                                            <input type="date" class="form-control" id="periodFrom">
                                        </div>
                                        <div class="mb-3">
                                            <label for="periodTo" class="form-label">Period To</label>
                                            <input type="date" class="form-control" id="periodTo">
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="row">
                                    <div class="col-md-4">
                                        <h4>Contractor Information</h4>
                                        <div class="mb-3">
                                            <label for="contractorName" class="form-label">Contractor Name</label>
                                            <input type="text" class="form-control" id="contractorName" placeholder="Enter contractor name">
                                        </div>
                                        <div class="mb-3">
                                            <label for="contractorAddress" class="form-label">Contractor Address</label>
                                            <textarea class="form-control" id="contractorAddress" rows="3" placeholder="Enter contractor address"></textarea>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <h4>Owner Information</h4>
                                        <div class="mb-3">
                                            <label for="ownerName" class="form-label">Owner Name</label>
                                            <input type="text" class="form-control" id="ownerName" placeholder="Enter owner name">
                                        </div>
                                        <div class="mb-3">
                                            <label for="ownerAddress" class="form-label">Owner Address</label>
                                            <textarea class="form-control" id="ownerAddress" rows="3" placeholder="Enter owner address"></textarea>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <h4>Architect Information</h4>
                                        <div class="mb-3">
                                            <label for="architectName" class="form-label">Architect Name</label>
                                            <input type="text" class="form-control" id="architectName" placeholder="Enter architect name">
                                        </div>
                                        <div class="mb-3">
                                            <label for="architectAddress" class="form-label">Architect Address</label>
                                            <textarea class="form-control" id="architectAddress" rows="3" placeholder="Enter architect address"></textarea>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="d-flex justify-content-end mt-3">
                                    <button class="btn btn-primary" onclick="moveToTab('g702-tab')">Next: G702 Form</button>
                                </div>
                            </div>
                            
                            <!-- G702 Tab -->
                            <div class="tab-pane fade" id="g702" role="tabpanel" aria-labelledby="g702-tab">
                                <div class="row mb-4">
                                    <div class="col-12">
                                        <h4>Contract Summary</h4>
                                        <div class="row">
                                            <div class="col-md-6">
                                                <div class="mb-3">
                                                    <label for="originalContractSum" class="form-label">1. Original Contract Sum</label>
                                                    <div class="input-group">
                                                        <span class="input-group-text">$</span>
                                                        <input type="number" class="form-control" id="originalContractSum" min="0" step="0.01" value="0.00">
                                                    </div>
                                                </div>
                                                <div class="mb-3">
                                                    <label for="changeOrders" class="form-label">2. Net Change by Change Orders</label>
                                                    <div class="input-group">
                                                        <span class="input-group-text">$</span>
                                                        <input type="number" class="form-control" id="changeOrders" min="0" step="0.01" value="0.00">
                                                    </div>
                                                </div>
                                                <div class="mb-3">
                                                    <label for="contractSum" class="form-label">3. Contract Sum to Date (Line 1 ± 2)</label>
                                                    <div class="input-group">
                                                        <span class="input-group-text">$</span>
                                                        <input type="number" class="form-control calculated" id="contractSum" readonly>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <div class="mb-3">
                                                    <label for="totalCompleted" class="form-label">4. Total Completed & Stored to Date</label>
                                                    <div class="input-group">
                                                        <span class="input-group-text">$</span>
                                                        <input type="number" class="form-control" id="totalCompleted" min="0" step="0.01" value="0.00">
                                                    </div>
                                                </div>
                                                <div class="mb-3">
                                                    <label for="retainage" class="form-label">5. Retainage</label>
                                                    <div class="input-group mb-2">
                                                        <input type="number" class="form-control" id="retainagePercentage" min="0" max="100" step="0.1" value="5">
                                                        <span class="input-group-text">%</span>
                                                    </div>
                                                    <div class="input-group">
                                                        <span class="input-group-text">$</span>
                                                        <input type="number" class="form-control calculated" id="retainageAmount" readonly>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="row mb-4">
                                    <div class="col-12">
                                        <h4>Payment Summary</h4>
                                        <div class="row">
                                            <div class="col-md-6">
                                                <div class="mb-3">
                                                    <label for="totalEarnedLessRetainage" class="form-label">6. Total Earned Less Retainage</label>
                                                    <div class="input-group">
                                                        <span class="input-group-text">$</span>
                                                        <input type="number" class="form-control calculated" id="totalEarnedLessRetainage" readonly>
                                                    </div>
                                                </div>
                                                <div class="mb-3">
                                                    <label for="lessPayments" class="form-label">7. Less Previous Certificates for Payment</label>
                                                    <div class="input-group">
                                                        <span class="input-group-text">$</span>
                                                        <input type="number" class="form-control" id="lessPayments" min="0" step="0.01" value="0.00">
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <div class="mb-3">
                                                    <label for="currentPaymentDue" class="form-label">8. Current Payment Due</label>
                                                    <div class="input-group">
                                                        <span class="input-group-text">$</span>
                                                        <input type="number" class="form-control calculated" id="currentPaymentDue" readonly>
                                                    </div>
                                                </div>
                                                <div class="mb-3">
                                                    <label for="balanceToFinish" class="form-label">9. Balance to Finish, Including Retainage</label>
                                                    <div class="input-group">
                                                        <span class="input-group-text">$</span>
                                                        <input type="number" class="form-control calculated" id="balanceToFinish" readonly>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="row mb-4">
                                    <div class="col-12">
                                        <h4>Change Order Summary</h4>
                                        <div class="table-responsive">
                                            <table class="table table-bordered aia-table" id="changeOrderTable">
                                                <thead>
                                                    <tr>
                                                        <th>ADDITIONS</th>
                                                        <th>DEDUCTIONS</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <tr>
                                                        <td>
                                                            <div class="mb-2">Total changes approved in previous months</div>
                                                            <div class="input-group">
                                                                <span class="input-group-text">$</span>
                                                                <input type="number" id="previousAdditions" min="0" step="0.01" value="0.00">
                                                            </div>
                                                        </td>
                                                        <td>
                                                            <div class="mb-2">Total changes approved in previous months</div>
                                                            <div class="input-group">
                                                                <span class="input-group-text">$</span>
                                                                <input type="number" id="previousDeductions" min="0" step="0.01" value="0.00">
                                                            </div>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td>
                                                            <div class="mb-2">Total changes approved this month</div>
                                                            <div class="input-group">
                                                                <span class="input-group-text">$</span>
                                                                <input type="number" id="currentAdditions" min="0" step="0.01" value="0.00">
                                                            </div>
                                                        </td>
                                                        <td>
                                                            <div class="mb-2">Total changes approved this month</div>
                                                            <div class="input-group">
                                                                <span class="input-group-text">$</span>
                                                                <input type="number" id="currentDeductions" min="0" step="0.01" value="0.00">
                                                            </div>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td>
                                                            <div class="mb-2">TOTALS</div>
                                                            <div class="input-group">
                                                                <span class="input-group-text">$</span>
                                                                <input type="number" id="totalAdditions" class="calculated" readonly>
                                                            </div>
                                                        </td>
                                                        <td>
                                                            <div class="mb-2">TOTALS</div>
                                                            <div class="input-group">
                                                                <span class="input-group-text">$</span>
                                                                <input type="number" id="totalDeductions" class="calculated" readonly>
                                                            </div>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td colspan="2">
                                                            <div class="mb-2">NET CHANGES BY CHANGE ORDERS</div>
                                                            <div class="input-group">
                                                                <span class="input-group-text">$</span>
                                                                <input type="number" id="netChangeOrders" class="calculated" readonly>
                                                            </div>
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="d-flex justify-content-between mt-3">
                                    <button class="btn btn-secondary" onclick="moveToTab('project-tab')">Previous: Project Info</button>
                                    <button class="btn btn-primary" onclick="moveToTab('g703-tab')">Next: G703 Form</button>
                                </div>
                            </div>
                            
                            <!-- G703 Tab -->
                            <div class="tab-pane fade" id="g703" role="tabpanel" aria-labelledby="g703-tab">
                                <div class="row mb-4">
                                    <div class="col-12">
                                        <h4>Continuation Sheet</h4>
                                        <div class="table-responsive">
                                            <table class="table table-bordered aia-table" id="g703Table">
                                                <thead>
                                                    <tr>
                                                        <th style="width: 5%">Item #</th>
                                                        <th style="width: 25%">Description of Work</th>
                                                        <th style="width: 10%">Scheduled Value</th>
                                                        <th colspan="2" style="width: 20%">Work Completed</th>
                                                        <th style="width: 10%">Materials Stored</th>
                                                        <th style="width: 10%">Total Completed and Stored to Date</th>
                                                        <th style="width: 5%">% Complete</th>
                                                        <th style="width: 10%">Balance to Finish</th>
                                                        <th style="width: 5%">Retainage</th>
                                                        <th style="width: 5%" class="no-print">Actions</th>
                                                    </tr>
                                                    <tr>
                                                        <th></th>
                                                        <th></th>
                                                        <th></th>
                                                        <th>From Previous Application</th>
                                                        <th>This Period</th>
                                                        <th></th>
                                                        <th></th>
                                                        <th></th>
                                                        <th></th>
                                                        <th></th>
                                                        <th class="no-print"></th>
                                                    </tr>
                                                </thead>
                                                <tbody id="lineItemsContainer">
                                                    <!-- Line items will be added here -->
                                                </tbody>
                                                <tfoot>
                                                    <tr>
                                                        <td colspan="2" class="text-end fw-bold">GRAND TOTAL</td>
                                                        <td>$<span id="totalScheduledValue">0.00</span></td>
                                                        <td>$<span id="totalPreviousWork">0.00</span></td>
                                                        <td>$<span id="totalCurrentWork">0.00</span></td>
                                                        <td>$<span id="totalMaterialsStored">0.00</span></td>
                                                        <td>$<span id="totalCompletedStored">0.00</span></td>
                                                        <td><span id="totalPercentComplete">0</span>%</td>
                                                        <td>$<span id="totalBalanceToFinish">0.00</span></td>
                                                        <td>$<span id="totalRetainage">0.00</span></td>
                                                        <td class="no-print"></td>
                                                    </tr>
                                                </tfoot>
                                            </table>
                                        </div>
                                        
                                        <div class="d-flex justify-content-start mt-3 no-print">
                                            <button class="btn btn-success me-2" id="addLineItem">
                                                <i class="fas fa-plus"></i> Add Line Item
                                            </button>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="d-flex justify-content-between mt-3">
                                    <button class="btn btn-secondary" onclick="moveToTab('g702-tab')">Previous: G702 Form</button>
                                    <button class="btn btn-primary" onclick="moveToTab('gc-tab')">Next: General Conditions</button>
                                </div>
                            </div>
                            
                            <!-- General Conditions Tab -->
                            <div class="tab-pane fade" id="gc" role="tabpanel" aria-labelledby="gc-tab">
                                <div class="row mb-4">
                                    <div class="col-12">
                                        <h4>General Conditions / Requirements</h4>
                                        <div class="table-responsive">
                                            <table class="table table-bordered aia-table" id="gcTable">
                                                <thead>
                                                    <tr>
                                                        <th style="width: 5%">Item #</th>
                                                        <th style="width: 30%">Description</th>
                                                        <th style="width: 10%">Budget Amount</th>
                                                        <th style="width: 10%">Previous Billed</th>
                                                        <th style="width: 10%">Current Billed</th>
                                                        <th style="width: 10%">Total Billed</th>
                                                        <th style="width: 10%">% Complete</th>
                                                        <th style="width: 10%">Balance Remaining</th>
                                                        <th style="width: 5%" class="no-print">Actions</th>
                                                    </tr>
                                                </thead>
                                                <tbody id="gcItemsContainer">
                                                    <!-- General conditions items will be added here -->
                                                </tbody>
                                                <tfoot>
                                                    <tr>
                                                        <td colspan="2" class="text-end fw-bold">TOTAL GENERAL CONDITIONS</td>
                                                        <td>$<span id="totalGCBudget">0.00</span></td>
                                                        <td>$<span id="totalGCPrevious">0.00</span></td>
                                                        <td>$<span id="totalGCCurrent">0.00</span></td>
                                                        <td>$<span id="totalGCBilled">0.00</span></td>
                                                        <td><span id="totalGCPercent">0</span>%</td>
                                                        <td>$<span id="totalGCBalance">0.00</span></td>
                                                        <td class="no-print"></td>
                                                    </tr>
                                                </tfoot>
                                            </table>
                                        </div>
                                        
                                        <div class="d-flex justify-content-start mt-3 no-print">
                                            <button class="btn btn-success me-2" id="addGCItem">
                                                <i class="fas fa-plus"></i> Add General Condition Item
                                            </button>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="d-flex justify-content-between mt-3">
                                    <button class="btn btn-secondary" onclick="moveToTab('g703-tab')">Previous: G703 Form</button>
                                    <button class="btn btn-primary" onclick="moveToTab('curve-tab')">Next: Job Cost Curve</button>
                                </div>
                            </div>
                            
                            <!-- Job Cost Curve Tab -->
                            <div class="tab-pane fade" id="curve" role="tabpanel" aria-labelledby="curve-tab">
                                <div class="row mb-4">
                                    <div class="col-md-6">
                                        <h4>Job Cost Bell Curve</h4>
                                        <p>Enter the project timeline and cost distribution information to generate a bell curve projection.</p>
                                        
                                        <div class="mb-3">
                                            <label for="projectStartDate" class="form-label">Project Start Date</label>
                                            <input type="date" class="form-control" id="projectStartDate">
                                        </div>
                                        
                                        <div class="mb-3">
                                            <label for="projectEndDate" class="form-label">Project End Date</label>
                                            <input type="date" class="form-control" id="projectEndDate">
                                        </div>
                                        
                                        <div class="mb-3">
                                            <label for="totalProjectCost" class="form-label">Total Project Cost</label>
                                            <div class="input-group">
                                                <span class="input-group-text">$</span>
                                                <input type="number" class="form-control" id="totalProjectCost" min="0" step="0.01" value="0.00">
                                            </div>
                                        </div>
                                        
                                        <div class="mb-3">
                                            <label for="curveType" class="form-label">Distribution Type</label>
                                            <select class="form-select" id="curveType">
                                                <option value="bell">Bell Curve (Normal Distribution)</option>
                                                <option value="frontLoaded">Front-Loaded (Early Heavy)</option>
                                                <option value="backLoaded">Back-Loaded (Late Heavy)</option>
                                                <option value="linear">Linear (Even Distribution)</option>
                                            </select>
                                        </div>
                                        
                                        <button class="btn btn-primary mt-3" id="generateCurve">Generate Cost Curve</button>
                                    </div>
                                    
                                    <div class="col-md-6">
                                        <div class="card">
                                            <div class="card-header">Job Cost Projection</div>
                                            <div class="card-body">
                                                <canvas id="costCurveChart" height="300"></canvas>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="row">
                                    <div class="col-12">
                                        <h4>Monthly Cost Breakdown</h4>
                                        <div class="table-responsive">
                                            <table class="table table-bordered" id="monthlyCostTable">
                                                <thead>
                                                    <tr>
                                                        <th>Month</th>
                                                        <th>Projected Cost</th>
                                                        <th>Cumulative Cost</th>
                                                        <th>% of Total</th>
                                                    </tr>
                                                </thead>
                                                <tbody id="monthlyCostBody">
                                                    <!-- Monthly cost data will be added here -->
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="d-flex justify-content-between mt-3">
                                    <button class="btn btn-secondary" onclick="moveToTab('gc-tab')">Previous: General Conditions</button>
                                    <button class="btn btn-primary" onclick="moveToTab('preview-tab')">Next: Preview & Export</button>
                                </div>
                            </div>
                            
                            <!-- Preview & Export Tab -->
                            <div class="tab-pane fade" id="preview" role="tabpanel" aria-labelledby="preview-tab">
                                <div class="row mb-4">
                                    <div class="col-12">
                                        <div class="d-flex justify-content-between mb-4">
                                            <h4>Preview AIA G702/G703 Forms</h4>
                                            <div>
                                                <button class="btn btn-primary me-2" id="exportPdf">
                                                    <i class="fas fa-file-pdf"></i> Export as PDF
                                                </button>
                                                <button class="btn btn-success" id="exportCsv">
                                                    <i class="fas fa-file-csv"></i> Export as CSV
                                                </button>
                                            </div>
                                        </div>
                                        
                                        <ul class="nav nav-tabs" id="previewTabs" role="tablist">
                                            <li class="nav-item" role="presentation">
                                                <button class="nav-link active" id="g702-preview-tab" data-bs-toggle="tab" data-bs-target="#g702-preview" type="button" role="tab" aria-controls="g702-preview" aria-selected="true">G702 Preview</button>
                                            </li>
                                            <li class="nav-item" role="presentation">
                                                <button class="nav-link" id="g703-preview-tab" data-bs-toggle="tab" data-bs-target="#g703-preview" type="button" role="tab" aria-controls="g703-preview" aria-selected="false">G703 Preview</button>
                                            </li>
                                            <li class="nav-item" role="presentation">
                                                <button class="nav-link" id="gc-preview-tab" data-bs-toggle="tab" data-bs-target="#gc-preview" type="button" role="tab" aria-controls="gc-preview" aria-selected="false">General Conditions</button>
                                            </li>
                                            <li class="nav-item" role="presentation">
                                                <button class="nav-link" id="curve-preview-tab" data-bs-toggle="tab" data-bs-target="#curve-preview" type="button" role="tab" aria-controls="curve-preview" aria-selected="false">Job Cost Curve</button>
                                            </li>
                                        </ul>
                                        
                                        <div class="tab-content" id="previewTabsContent">
                                            <!-- G702 Preview -->
                                            <div class="tab-pane fade show active" id="g702-preview" role="tabpanel" aria-labelledby="g702-preview-tab">
                                                <div class="preview-container" id="g702PreviewContainer">
                                                    <div class="aia-form">
                                                        <div class="row aia-header">
                                                            <div class="col-6">
                                                                <h3>APPLICATION AND CERTIFICATE FOR PAYMENT</h3>
                                                                <p>AIA Document G702 - 2017</p>
                                                            </div>
                                                            <div class="col-6 text-end">
                                                                <p>APPLICATION NO: <span id="preview-appNumber"></span></p>
                                                                <p>PERIOD TO: <span id="preview-periodTo"></span></p>
                                                                <p>PROJECT NO: <span id="preview-projectNumber"></span></p>
                                                            </div>
                                                        </div>
                                                        
                                                        <div class="row mb-4">
                                                            <div class="col-4">
                                                                <p><strong>FROM (CONTRACTOR):</strong></p>
                                                                <p id="preview-contractorInfo"></p>
                                                            </div>
                                                            <div class="col-4">
                                                                <p><strong>TO (OWNER):</strong></p>
                                                                <p id="preview-ownerInfo"></p>
                                                            </div>
                                                            <div class="col-4">
                                                                <p><strong>PROJECT:</strong></p>
                                                                <p id="preview-projectInfo"></p>
                                                                <p class="mt-3"><strong>APPLICATION DATE:</strong> <span id="preview-appDate"></span></p>
                                                            </div>
                                                        </div>
                                                        
                                                        <div class="row mb-4">
                                                            <div class="col-12">
                                                                <table class="table table-bordered">
                                                                    <tbody>
                                                                        <tr>
                                                                            <td style="width: 60%">
                                                                                <p><strong>1. ORIGINAL CONTRACT SUM</strong></p>
                                                                            </td>
                                                                            <td class="text-end">
                                                                                <p>$<span id="preview-originalSum"></span></p>
                                                                            </td>
                                                                        </tr>
                                                                        <tr>
                                                                            <td>
                                                                                <p><strong>2. NET CHANGE BY CHANGE ORDERS</strong></p>
                                                                            </td>
                                                                            <td class="text-end">
                                                                                <p>$<span id="preview-netChange"></span></p>
                                                                            </td>
                                                                        </tr>
                                                                        <tr>
                                                                            <td>
                                                                                <p><strong>3. CONTRACT SUM TO DATE (Line 1 ± 2)</strong></p>
                                                                            </td>
                                                                            <td class="text-end">
                                                                                <p>$<span id="preview-contractSum"></span></p>
                                                                            </td>
                                                                        </tr>
                                                                        <tr>
                                                                            <td>
                                                                                <p><strong>4. TOTAL COMPLETED & STORED TO DATE</strong> (Column G on G703)</p>
                                                                            </td>
                                                                            <td class="text-end">
                                                                                <p>$<span id="preview-totalCompleted"></span></p>
                                                                            </td>
                                                                        </tr>
                                                                        <tr>
                                                                            <td>
                                                                                <p><strong>5. RETAINAGE:</strong></p>
                                                                                <p class="ms-3"><span id="preview-retainagePercent"></span>% of Completed Work</p>
                                                                            </td>
                                                                            <td class="text-end">
                                                                                <p>$<span id="preview-retainageAmount"></span></p>
                                                                            </td>
                                                                        </tr>
                                                                        <tr>
                                                                            <td>
                                                                                <p><strong>6. TOTAL EARNED LESS RETAINAGE</strong></p>
                                                                                <p class="ms-3">(Line 4 minus Line 5 Total)</p>
                                                                            </td>
                                                                            <td class="text-end">
                                                                                <p>$<span id="preview-totalEarned"></span></p>
                                                                            </td>
                                                                        </tr>
                                                                        <tr>
                                                                            <td>
                                                                                <p><strong>7. LESS PREVIOUS CERTIFICATES FOR PAYMENT</strong></p>
                                                                                <p class="ms-3">(Line 6 from prior Certificate)</p>
                                                                            </td>
                                                                            <td class="text-end">
                                                                                <p>$<span id="preview-lessPrevious"></span></p>
                                                                            </td>
                                                                        </tr>
                                                                        <tr>
                                                                            <td>
                                                                                <p><strong>8. CURRENT PAYMENT DUE</strong></p>
                                                                            </td>
                                                                            <td class="text-end">
                                                                                <p>$<span id="preview-currentPayment"></span></p>
                                                                            </td>
                                                                        </tr>
                                                                        <tr>
                                                                            <td>
                                                                                <p><strong>9. BALANCE TO FINISH, INCLUDING RETAINAGE</strong></p>
                                                                                <p class="ms-3">(Line 3 minus Line 6)</p>
                                                                            </td>
                                                                            <td class="text-end">
                                                                                <p>$<span id="preview-balanceToFinish"></span></p>
                                                                            </td>
                                                                        </tr>
                                                                    </tbody>
                                                                </table>
                                                            </div>
                                                        </div>
                                                        
                                                        <div class="row mb-4">
                                                            <div class="col-12">
                                                                <table class="table table-bordered">
                                                                    <thead>
                                                                        <tr>
                                                                            <th colspan="3">CHANGE ORDER SUMMARY</th>
                                                                            <th>ADDITIONS</th>
                                                                            <th>DEDUCTIONS</th>
                                                                        </tr>
                                                                    </thead>
                                                                    <tbody>
                                                                        <tr>
                                                                            <td colspan="3">Total changes approved in previous months</td>
                                                                            <td class="text-end">$<span id="preview-prevAdditions"></span></td>
                                                                            <td class="text-end">$<span id="preview-prevDeductions"></span></td>
                                                                        </tr>
                                                                        <tr>
                                                                            <td colspan="3">Total approved this month</td>
                                                                            <td class="text-end">$<span id="preview-currAdditions"></span></td>
                                                                            <td class="text-end">$<span id="preview-currDeductions"></span></td>
                                                                        </tr>
                                                                        <tr>
                                                                            <td colspan="3">TOTALS</td>
                                                                            <td class="text-end">$<span id="preview-totalAdditions"></span></td>
                                                                            <td class="text-end">$<span id="preview-totalDeductions"></span></td>
                                                                        </tr>
                                                                        <tr>
                                                                            <td colspan="3">NET CHANGES by Change Order</td>
                                                                            <td colspan="2" class="text-center">$<span id="preview-netChangeOrders"></span></td>
                                                                        </tr>
                                                                    </tbody>
                                                                </table>
                                                            </div>
                                                        </div>
                                                        
                                                        <div class="row aia-footer">
                                                            <div class="col-12">
                                                                <p>The undersigned Contractor certifies that to the best of the Contractor's knowledge, information and belief the Work covered by this Application for Payment has been completed in accordance with the Contract Documents.</p>
                                                            </div>
                                                            <div class="col-4 mt-4">
                                                                <p><strong>CONTRACTOR:</strong></p>
                                                                <p>By: ________________________________</p>
                                                                <p>Date: ____________________________</p>
                                                            </div>
                                                            <div class="col-4 mt-4">
                                                                <p><strong>ARCHITECT:</strong></p>
                                                                <p>By: ________________________________</p>
                                                                <p>Date: ____________________________</p>
                                                            </div>
                                                            <div class="col-4 mt-4">
                                                                <p><strong>OWNER:</strong></p>
                                                                <p>By: ________________________________</p>
                                                                <p>Date: ____________________________</p>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            
                                            <!-- G703 Preview -->
                                            <div class="tab-pane fade" id="g703-preview" role="tabpanel" aria-labelledby="g703-preview-tab">
                                                <div class="preview-container" id="g703PreviewContainer">
                                                    <div class="aia-form">
                                                        <div class="row aia-header">
                                                            <div class="col-6">
                                                                <h3>CONTINUATION SHEET</h3>
                                                                <p>AIA Document G703 - 2017</p>
                                                            </div>
                                                            <div class="col-6 text-end">
                                                                <p>APPLICATION NO: <span id="preview-g703-appNumber"></span></p>
                                                                <p>APPLICATION DATE: <span id="preview-g703-appDate"></span></p>
                                                                <p>PERIOD TO: <span id="preview-g703-periodTo"></span></p>
                                                                <p>PROJECT NO: <span id="preview-g703-projectNumber"></span></p>
                                                            </div>
                                                        </div>
                                                        
                                                        <div class="row mb-3">
                                                            <div class="col-12">
                                                                <table class="table table-bordered" id="g703PreviewTable">
                                                                    <thead>
                                                                        <tr>
                                                                            <th>A</th>
                                                                            <th>B</th>
                                                                            <th>C</th>
                                                                            <th colspan="2">D</th>
                                                                            <th>E</th>
                                                                            <th>F</th>
                                                                            <th>G</th>
                                                                            <th>H</th>
                                                                            <th>I</th>
                                                                        </tr>
                                                                        <tr>
                                                                            <th>ITEM NO.</th>
                                                                            <th>DESCRIPTION OF WORK</th>
                                                                            <th>SCHEDULED VALUE</th>
                                                                            <th>FROM PREVIOUS APPLICATION</th>
                                                                            <th>THIS PERIOD</th>
                                                                            <th>MATERIALS PRESENTLY STORED</th>
                                                                            <th>TOTAL COMPLETED AND STORED TO DATE (D+E+F)</th>
                                                                            <th>% (G÷C)</th>
                                                                            <th>BALANCE TO FINISH (C-G)</th>
                                                                            <th>RETAINAGE</th>
                                                                        </tr>
                                                                    </thead>
                                                                    <tbody id="g703PreviewBody">
                                                                        <!-- G703 line items will be populated by JavaScript -->
                                                                    </tbody>
                                                                    <tfoot>
                                                                        <tr>
                                                                            <td colspan="2" class="text-end fw-bold">GRAND TOTAL</td>
                                                                            <td>$<span id="preview-g703-totalScheduled"></span></td>
                                                                            <td>$<span id="preview-g703-totalPrevious"></span></td>
                                                                            <td>$<span id="preview-g703-totalCurrent"></span></td>
                                                                            <td>$<span id="preview-g703-totalMaterials"></span></td>
                                                                            <td>$<span id="preview-g703-totalComplete"></span></td>
                                                                            <td><span id="preview-g703-totalPercent"></span>%</td>
                                                                            <td>$<span id="preview-g703-totalBalance"></span></td>
                                                                            <td>$<span id="preview-g703-totalRetainage"></span></td>
                                                                        </tr>
                                                                    </tfoot>
                                                                </table>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            
                                            <!-- General Conditions Preview -->
                                            <div class="tab-pane fade" id="gc-preview" role="tabpanel" aria-labelledby="gc-preview-tab">
                                                <div class="preview-container" id="gcPreviewContainer">
                                                    <div class="aia-form">
                                                        <div class="row aia-header">
                                                            <div class="col-6">
                                                                <h3>GENERAL CONDITIONS</h3>
                                                                <p>Project Requirements</p>
                                                            </div>
                                                            <div class="col-6 text-end">
                                                                <p>APPLICATION NO: <span id="preview-gc-appNumber"></span></p>
                                                                <p>APPLICATION DATE: <span id="preview-gc-appDate"></span></p>
                                                                <p>PERIOD TO: <span id="preview-gc-periodTo"></span></p>
                                                                <p>PROJECT NO: <span id="preview-gc-projectNumber"></span></p>
                                                            </div>
                                                        </div>
                                                        
                                                        <div class="row mb-3">
                                                            <div class="col-12">
                                                                <table class="table table-bordered" id="gcPreviewTable">
                                                                    <thead>
                                                                        <tr>
                                                                            <th>ITEM NO.</th>
                                                                            <th>DESCRIPTION</th>
                                                                            <th>BUDGET AMOUNT</th>
                                                                            <th>PREVIOUS BILLED</th>
                                                                            <th>CURRENT BILLED</th>
                                                                            <th>TOTAL BILLED</th>
                                                                            <th>% COMPLETE</th>
                                                                            <th>BALANCE REMAINING</th>
                                                                        </tr>
                                                                    </thead>
                                                                    <tbody id="gcPreviewBody">
                                                                        <!-- General conditions items will be populated by JavaScript -->
                                                                    </tbody>
                                                                    <tfoot>
                                                                        <tr>
                                                                            <td colspan="2" class="text-end fw-bold">TOTAL GENERAL CONDITIONS</td>
                                                                            <td>$<span id="preview-gc-totalBudget"></span></td>
                                                                            <td>$<span id="preview-gc-totalPrevious"></span></td>
                                                                            <td>$<span id="preview-gc-totalCurrent"></span></td>
                                                                            <td>$<span id="preview-gc-totalBilled"></span></td>
                                                                            <td><span id="preview-gc-totalPercent"></span>%</td>
                                                                            <td>$<span id="preview-gc-totalBalance"></span></td>
                                                                        </tr>
                                                                    </tfoot>
                                                                </table>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            
                                            <!-- Job Cost Curve Preview -->
                                            <div class="tab-pane fade" id="curve-preview" role="tabpanel" aria-labelledby="curve-preview-tab">
                                                <div class="preview-container" id="curvePreviewContainer">
                                                    <div class="aia-form">
                                                        <div class="row aia-header">
                                                            <div class="col-6">
                                                                <h3>JOB COST BELL CURVE</h3>
                                                                <p>Project Cost Projection</p>
                                                            </div>
                                                            <div class="col-6 text-end">
                                                                <p>PROJECT: <span id="preview-curve-project"></span></p>
                                                                <p>PROJECT NO: <span id="preview-curve-projectNumber"></span></p>
                                                            </div>
                                                        </div>
                                                        
                                                        <div class="row mb-4">
                                                            <div class="col-12">
                                                                <canvas id="previewCurveChart" height="300"></canvas>
                                                            </div>
                                                        </div>
                                                        
                                                        <div class="row mb-3">
                                                            <div class="col-12">
                                                                <table class="table table-bordered" id="curvePreviewTable">
                                                                    <thead>
                                                                        <tr>
                                                                            <th>Month</th>
                                                                            <th>Projected Cost</th>
                                                                            <th>Cumulative Cost</th>
                                                                            <th>% of Total</th>
                                                                        </tr>
                                                                    </thead>
                                                                    <tbody id="curvePreviewBody">
                                                                        <!-- Monthly cost data will be populated by JavaScript -->
                                                                    </tbody>
                                                                </table>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="d-flex justify-content-start mt-3">
                                    <button class="btn btn-secondary" onclick="moveToTab('curve-tab')">Previous: Job Cost Curve</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/chart.js/3.9.1/chart.min.js"></script>
    <script src="script.js"></script>
</body>
</html>